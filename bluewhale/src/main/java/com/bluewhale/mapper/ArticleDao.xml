<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.bluewhale.mapper.ArticleDao">
	<!-- 查询文章总数 -->
	<select id="getArticleTotal" resultType="Integer">
		select count(*) from blog_article
	</select>
	
	<!-- 添加文章 -->
	<insert id="addArticle" parameterType="article" keyProperty="id" useGeneratedKeys="true"> 
		insert into blog_article(title,summary,type,content,htmlcontent,ownerid,submitdata,comment) 
			values(#{title},#{summary},#{type},#{content},#{htmlcontent},#{ownerid},#{submitdata},#{comment})
	</insert>
	
	<!-- 通过id查询文章 -->
	<select id="getArticleById" parameterType="Integer" resultType="article">
		select * from blog_article
		<where>
			id = #{value}
		</where>
	</select>
	
	<!-- 通过id删除文章 -->
	<delete id="deleteArticleById" parameterType="Integer">
		delete from blog_article
		<where>
			id = #{value}
		</where>
	</delete>
	
	<!-- 查询文章 -->
	<select id="getArticle" parameterType="queryVo" resultType="article">
		select * from blog_article limit #{beginIndex},#{pageSize}
	</select>

	<!-- 通过id查询点赞数 -->
	<select id="getZanCount" parameterType="Integer" resultType="Integer">
		select count(*) from blog_zan where aid = #{value}
	</select>
	
	<!-- 判断文章是否已被点赞 -->
	<select id="isDianZan" parameterType="pd" resultType="pd">
		select * from blog_zan where aid=#{aid} and uid=#{uid}
	</select>
	
	<!-- 删除点赞 -->
	<delete id="deleteDianZan" parameterType="pd">
		delete from blog_zan where aid=#{aid} and uid=#{uid}
	</delete>
	
	<!-- 添加点赞 -->
	<insert id="addDianZan" parameterType="pd">
		insert into blog_zan (aid,uid)
		values(#{aid},#{uid})
	</insert>
	
</mapper>